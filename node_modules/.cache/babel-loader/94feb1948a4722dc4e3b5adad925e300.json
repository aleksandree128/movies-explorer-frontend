{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\aleks\\\\dev\\\\movies-explorer-frontend\\\\src\\\\components\\\\Movie\\\\Movie.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport MoviesCardList from \"../MovieCardsLists/MovieCardsLists\";\nimport \"../Movie/movie.css\";\nimport \"../SeacrhForm/seacrhForm.css\";\nimport SearchForm from \"../SeacrhForm/SeacrhForm\";\nimport Loader from \"../Loader/Loader\";\nimport moviesApi from \"../../utils/MovieApi\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction Movies(_ref) {\n  _s();\n\n  let {\n    user = {},\n    onSaveClick = false,\n    onDeleteClick = false,\n    onSavedMovie = []\n  } = _ref;\n  const [isDataLoading, setIsDataLoading] = React.useState(false);\n  const [shortMovies, setShortMovies] = React.useState(false);\n  const [filteredMovies, setFilteredMovies] = React.useState([]);\n  const [initialMovies, setInitialMovies] = React.useState([]);\n  const [nothingFound, setNothingFound] = React.useState(true);\n  const [inputValue, setInputValue] = React.useState(false);\n  const [isError, setIsError] = React.useState(false);\n\n  function filterMovies(movies, request, shortMoviesSwitch) {\n    const foundMovies = movies.filter(movie => {\n      return movie.nameRU.toLowerCase().includes(request.toLowerCase());\n    });\n\n    if (shortMoviesSwitch) {\n      return filterShortMovies(foundMovies);\n    } else {\n      return foundMovies;\n    }\n  }\n\n  function handleSetFilteredMovies(movies, request, shortMoviesSwitch) {\n    const moviesList = filterMovies(movies, request, shortMoviesSwitch);\n    moviesList.length === 0 ? setNothingFound(true) : setNothingFound(false);\n    setInitialMovies(moviesList);\n    setFilteredMovies(shortMoviesSwitch ? filterShortMovies(moviesList) : moviesList);\n    localStorage.setItem(\"movies\", JSON.stringify(moviesList));\n  }\n\n  function handleSearchSubmit(inputValue) {\n    setIsDataLoading(true);\n    localStorage.setItem(\"movieSearch\", inputValue);\n    localStorage.setItem(\"shortMovies\", shortMovies);\n    moviesApi.getMovies().then(res => {\n      handleSetFilteredMovies(res, inputValue, shortMovies);\n    }).catch(err => {\n      setIsError(true);\n      console.log(err);\n    }).finally(() => setIsDataLoading(false));\n  }\n\n  function filterShortMovies(movies) {\n    return movies.filter(movie => movie.duration <= 40);\n  }\n\n  function handleShortFilms() {\n    setShortMovies(!shortMovies);\n\n    if (!shortMovies) {\n      if (filterShortMovies(initialMovies).length === 0) {\n        setFilteredMovies(filterShortMovies(initialMovies));\n        setNothingFound(true);\n      } else {\n        setFilteredMovies(filterShortMovies(initialMovies));\n        setNothingFound(false);\n      }\n    } else {\n      initialMovies.length === 0 ? setNothingFound(true) : setNothingFound(false);\n      setFilteredMovies(initialMovies);\n    }\n\n    localStorage.setItem(\"shortMovies\", !shortMovies);\n  }\n\n  React.useEffect(() => {\n    if (localStorage.getItem(\"movieSearch\")) {\n      setInputValue(localStorage.getItem(\"movieSearch\"));\n    }\n  }, []);\n  React.useEffect(() => {\n    if (localStorage.getItem(\"shortMovies\") === \"true\") {\n      setShortMovies(true);\n    } else {\n      setShortMovies(false);\n    }\n  }, [user]);\n  React.useEffect(() => {\n    if (localStorage.getItem(\"movies\")) {\n      const movies = JSON.parse(localStorage.getItem(\"movies\"));\n      movies.length === 0 ? setNothingFound(true) : setNothingFound(false);\n      setInitialMovies(movies);\n\n      if (localStorage.getItem(\"shortMovies\") === \"true\") {\n        setFilteredMovies(filterShortMovies(movies));\n      } else {\n        setFilteredMovies(movies);\n      }\n    } else {\n      setNothingFound(true);\n    }\n  }, [user]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(SearchForm, {\n      handleSearchSubmit: handleSearchSubmit,\n      checkBoxClick: handleShortFilms,\n      inputValue: inputValue,\n      shortMovies: shortMovies\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 13\n    }, this), isDataLoading ? /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 17\n    }, this) : '', initialMovies.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"moviesCardList__notFound\",\n      children: \"\\u041D\\u0438\\u0447\\u0435\\u0433\\u043E \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u043E.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 15\n    }, this) : /*#__PURE__*/_jsxDEV(MoviesCardList, {\n      moviesList: filteredMovies,\n      nothingFound: nothingFound,\n      onSaveClick: onSaveClick,\n      onDeleteClick: onDeleteClick,\n      savedMoviesList: onSavedMovie,\n      savedMoviesPage: false\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true);\n}\n\n_s(Movies, \"lQI4oD8CGSOQ3vrd2CY7LX7h7tI=\");\n\n_c = Movies;\nexport default Movies;\n\nvar _c;\n\n$RefreshReg$(_c, \"Movies\");","map":{"version":3,"names":["React","MoviesCardList","SearchForm","Loader","moviesApi","Movies","user","onSaveClick","onDeleteClick","onSavedMovie","isDataLoading","setIsDataLoading","useState","shortMovies","setShortMovies","filteredMovies","setFilteredMovies","initialMovies","setInitialMovies","nothingFound","setNothingFound","inputValue","setInputValue","isError","setIsError","filterMovies","movies","request","shortMoviesSwitch","foundMovies","filter","movie","nameRU","toLowerCase","includes","filterShortMovies","handleSetFilteredMovies","moviesList","length","localStorage","setItem","JSON","stringify","handleSearchSubmit","getMovies","then","res","catch","err","console","log","finally","duration","handleShortFilms","useEffect","getItem","parse"],"sources":["C:/Users/aleks/dev/movies-explorer-frontend/src/components/Movie/Movie.js"],"sourcesContent":["import React from \"react\";\r\nimport MoviesCardList from \"../MovieCardsLists/MovieCardsLists\";\r\nimport \"../Movie/movie.css\";\r\nimport \"../SeacrhForm/seacrhForm.css\";\r\nimport SearchForm from \"../SeacrhForm/SeacrhForm\";\r\nimport Loader from \"../Loader/Loader\";\r\nimport moviesApi from \"../../utils/MovieApi\";\r\n\r\nfunction Movies({\r\n    user = {},\r\n    onSaveClick = false,\r\n    onDeleteClick = false,\r\n    onSavedMovie = [],\r\n}) {\r\n    const [isDataLoading, setIsDataLoading] = React.useState(false);\r\n    const [shortMovies, setShortMovies] = React.useState(false);\r\n    const [filteredMovies, setFilteredMovies] = React.useState([]);\r\n    const [initialMovies, setInitialMovies] = React.useState([]);\r\n    const [nothingFound, setNothingFound] = React.useState(true);\r\n    const [inputValue, setInputValue] = React.useState(false);\r\n    const [isError, setIsError] = React.useState(false);\r\n\r\n    function filterMovies(movies, request, shortMoviesSwitch) {\r\n        const foundMovies = movies.filter((movie) => {\r\n            return movie.nameRU.toLowerCase().includes(request.toLowerCase());\r\n        });\r\n\r\n        if (shortMoviesSwitch) {\r\n            return filterShortMovies(foundMovies);\r\n        } else {\r\n            return foundMovies;\r\n        }\r\n    }\r\n\r\n    function handleSetFilteredMovies(movies, request, shortMoviesSwitch) {\r\n        const moviesList = filterMovies(movies, request, shortMoviesSwitch);\r\n        moviesList.length === 0\r\n            ? setNothingFound(true)\r\n            : setNothingFound(false);\r\n        setInitialMovies(moviesList);\r\n        setFilteredMovies(\r\n            shortMoviesSwitch ? filterShortMovies(moviesList) : moviesList\r\n        );\r\n        localStorage.setItem(\"movies\", JSON.stringify(moviesList));\r\n    }\r\n\r\n    function handleSearchSubmit(inputValue) {\r\n        setIsDataLoading(true);\r\n        localStorage.setItem(\"movieSearch\", inputValue);\r\n        localStorage.setItem(\"shortMovies\", shortMovies);\r\n        moviesApi\r\n            .getMovies()\r\n            .then((res) => {\r\n                handleSetFilteredMovies(res, inputValue, shortMovies);\r\n            })\r\n            .catch((err) => {\r\n                setIsError(true);\r\n                console.log(err);\r\n            })\r\n            .finally(() => setIsDataLoading(false));\r\n    }\r\n\r\n    function filterShortMovies(movies) {\r\n        return movies.filter((movie) => movie.duration <= 40);\r\n    }\r\n\r\n    function handleShortFilms() {\r\n        setShortMovies(!shortMovies);\r\n        if (!shortMovies) {\r\n            if (filterShortMovies(initialMovies).length === 0) {\r\n                setFilteredMovies(filterShortMovies(initialMovies));\r\n                setNothingFound(true);\r\n            } else {\r\n                setFilteredMovies(filterShortMovies(initialMovies));\r\n                setNothingFound(false);\r\n            }\r\n        } else {\r\n            initialMovies.length === 0\r\n                ? setNothingFound(true)\r\n                : setNothingFound(false);\r\n            setFilteredMovies(initialMovies);\r\n        }\r\n        localStorage.setItem(\"shortMovies\", !shortMovies);\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        if (localStorage.getItem(\"movieSearch\")) {\r\n            setInputValue(localStorage.getItem(\"movieSearch\"));\r\n        }\r\n    }, []);\r\n\r\n    React.useEffect(() => {\r\n        if (localStorage.getItem(\"shortMovies\") === \"true\") {\r\n            setShortMovies(true);\r\n        } else {\r\n            setShortMovies(false);\r\n        }\r\n    }, [user]);\r\n\r\n    React.useEffect(() => {\r\n        if (localStorage.getItem(\"movies\")) {\r\n            const movies = JSON.parse(localStorage.getItem(\"movies\"));\r\n            movies.length === 0\r\n                ? setNothingFound(true)\r\n                : setNothingFound(false);\r\n            setInitialMovies(movies);\r\n            if (localStorage.getItem(\"shortMovies\") === \"true\") {\r\n                setFilteredMovies(filterShortMovies(movies));\r\n            } else {\r\n                setFilteredMovies(movies);\r\n            }\r\n        } else {\r\n            setNothingFound(true);\r\n        }\r\n    }, [user]);\r\n\r\n    return (\r\n        <>\r\n            <SearchForm\r\n                handleSearchSubmit={handleSearchSubmit}\r\n                checkBoxClick={handleShortFilms}\r\n                inputValue={inputValue}\r\n                shortMovies={shortMovies}\r\n            />\r\n            {isDataLoading ?\r\n                <Loader /> : ''}\r\n            {initialMovies.length === 0\r\n            ? <p className=\"moviesCardList__notFound\">\r\n                    Ничего не найдено.\r\n                </p> :\r\n                <MoviesCardList\r\n                    moviesList={filteredMovies}\r\n                    nothingFound={nothingFound}\r\n                    onSaveClick={onSaveClick}\r\n                    onDeleteClick={onDeleteClick}\r\n                    savedMoviesList={onSavedMovie}\r\n                    savedMoviesPage={false}\r\n                />\r\n            }\r\n        </>\r\n    );\r\n}\r\n\r\nexport default Movies;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}